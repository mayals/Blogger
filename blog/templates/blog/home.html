{% extends 'base.html' %}
{% load static %}


<!-- start inlclude  'message' -->
{% block messages %}
   {% include 'blog/includes/messages.html' %}
{% endblock messages %}
<!-- END inlclude  'message' -->



{% block content %}



<!--Start include Carousel-->
   {% include 'blog/includes/carsousel.html' %}
<!--End  include Carousel-->



<!--Start Category row -->
<br>
<div class='container'>
        <div class="card">
            <div class="card-header text-center ">Ctegories({{ categories.count }})</div>
                <div class="row card-body justify-content-between m-1">
                        {% for cat in categories %}
                        
                            <div class='col-lg-2 col-md-6 col-sm-6 col-xs-6 rounded d-flex justify-content-center'>
                                {% if cat.icon %}
                                    <a  href="{% url 'blog:home-filter-category'  catslug=cat.slug  %}">   
                                        <figure class="figure">
                                            <img src="{{ cat.icon.url }}" class="rounded"  width="100" height="100" alt="{{cat.name}}">
                                            <figcaption class="figure-caption"><small>{{ cat.name }}</small></figcaption>
                                        </figure>
                                    </a> 
                                {% else %}
                                    <figure class="figure">
                                        <img src="{% static 'img/cat_default.png' %}" width="100" height="100" alt="{{cat.name}}">
                                        <figcaption class="figure-caption"><small>{{ cat.name }}</small></figcaption>
                                    </figure>
                                {% endif %}
                            </div>
                     
                        {% empty %}
                            <div class="border p-3 mb-3">
                                <p>No Category!</p> 
                            </div>  
                        {% endfor %}
                </div>
            </div>
        </div>
    </div>        
<!--End Category row -->


   


<!--Start 2 columns grid  -->
<section class='container'>
    <h1 class="screen-reader-only">Posts List for web development applications Skills</h1>      
    <div class="row mt-4">
        <!-- Start posts-->
        <div class="col-md-8">
            <!-- add new post-->
            {% if request.user.is_authenticated %}
            <a type="button" href='{% url 'blog:new-post' %}' class="btn btn-sm btn-dark text-warning"><i class="fa fa-plus" aria-hidden="true"></i> Add Post</a>
            <br> <br>
            {% endif %} 
              <!-- posts list -->
            {% for post in posts %}
            <div class="card mb-3">
                {% if post.photo %}
                    <img class="card-img-top img-fluid" src="{{post.photo.url}}" width="150" height="250" alt="{{post.title}}">
                {% else %}
                    <img class="card-img-top img-fluid" src="{% static 'img/post_default.png' %}"  width="150" height="250" alt="{{post.title}}">
                {% endif %}    
                <div class="card-body pt-0">
                    <a href="{% url 'blog:post-detail' slug=post.slug %}"><h2 class="card-title">{{post.title}}</h2></a>
                    <div class='row'>
                        <div class='col-md-auto d-flex justify-content-start align-items-center'>
                            {% if post.get_user.profile.profile_pic %}
                                <img class='rounded-circle  mb-1' src="{{ post.get_user.profile.profile_pic.url }}"  width="50" height="50" alt="{{post.author.first_name}}">
                            {% else %}
                                <img class='rounded-circle  mb-1' src="{% static 'img/profile_default.webp' %}"  width="50" height="50" alt="{{post.author.first_name}}">
                            {% endif %} 
                        </div>
                        <div class='col-md-auto d-flex justify-content-start align-items-center'>
                            <p>&nbsp<small class="text-muted"><i class="fa-solid fa-pen-nib"></i>  {{post.author.get_user_fullname}}</small></p>&nbsp &nbsp &nbsp &nbsp
                            <p><small class="text-muted"><i class="fa-regular fa-calendar-days"></i>  {{post.created_at|date:'d-m-Y'}}</small></p>
                        </div>
                        <div class='col-md d-flex justify-content-end  align-items-center mb-2'>
                            <i class="fa-regular fa-share-nodes fa-lg" style="color:#A9AA9E"></i>
                            
                            &nbsp &nbsp &nbsp &nbsp
                           
                            <span  class="position-relative">
                                <i class="fa-regular fa-eye fa-lg" style="color:#68b1cc"></i> 
                                <span class="position-absolute top-0 start-100 translate-middle badge rounded-pill bg-dark opacity-50">
                                    <text class='text-light'>{{ post.comments.all.count }}<text>
                                    <span class="visually-hidden">views</span>
                                </span>
                            </span>
        
                            &nbsp &nbsp &nbsp &nbsp
        
                            <span  class="position-relative">
                                <i class="fa-regular fa-heart fa-lg" style="color:#EF4990"></i> 
                                <span class="position-absolute top-0 start-100 translate-middle badge rounded-pill bg-dark opacity-50">
                                    <text class='text-light'>{{ post.comments.all.count }}<text>
                                    <span class="visually-hidden">likes</span>
                                </span>
                            </span>
        
                            &nbsp &nbsp &nbsp &nbsp
        
                            <span  class="position-relative">
                                <i class="fa-regular fa-message fa-lg" style="color:#96cc4d"></i> 
                                <span class="position-absolute top-0 start-100 translate-middle badge rounded-pill bg-dark opacity-50">
                                    <text class='text-light'>{{ post.comments.all.count }}<text>
                                    <span class="visually-hidden">comments</span>
                                </span>
                            </span>
                        </div>
                        <div>
                            <p class="card-text">
                               {{  post.content|truncatewords:20|safe }}&nbsp<a href="{% url 'blog:post-detail' slug=post.slug %}" class='btn-light'>Read more</a>
                            </p>
                        </div>   
                    </div>
                </div>
            </div>
            <br>
            {% empty %}
            <div class="border p-3 mb-3">
                <p>No Post!</p> 
            </div>
            {% endfor %}
        </div>
        <!-- End posts-->

        
        <div class="col-md-4">
                <!--Start tags-->
                <div class="card text-dark bg-light mb-3">
                    <div class="card-header text-center">Tags({{ tags.count }})</div>
                    <div class="card-body">
                        {% for tag in tags %}
                        <a type="button" href="{% url 'blog:home-filter-tag' tagslug=tag.slug %}"  class="btn btn-secondary m-1" >
                            #{{ tag.slug }} <span class="badge bg-warning">{{tag.get_tag_posts.count}}</span>
                        </a>
                        {% empty %}
                        <div class="border p-3 mb-3">
                            <p>No Tag!</p> 
                        </div>
                        {% endfor %}
                    </div>
                </div>
                <!-- End tags-->


                    <br>
                    <br>
             


                <!--Start category names -->
                <div class="card text-dark bg-light mb-3">
                    <div class="card-header text-center">Categories({{ categories.count }})</div>
                    <div class="card-body">
                        {% for cat in categories %}
                        <a type="button" href="{% url 'blog:home-filter-category' catslug=cat.slug %}"  class="btn btn-secondary m-1" >
                            {{ cat.name }} <span class="badge bg-warning">{{ cat.get_category_posts.count }}</span>
                        </a>
                            {% empty %}
                        <div class="border p-3 mb-3">
                            <p>No Category!</p> 
                        </div>
                        {% endfor %}
                    </div>
                </div>
                <!-- End category names-->
        </div>
        
    </div>
</section>
<!--END 2 columns grid   -->
{% endblock content %}